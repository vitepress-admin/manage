import{d as $,aa as Z,r as m,ab as x,b as ee,c as oe,p as e,q as t,e as l,ag as te,a as ae,a1 as le,o as v,w as p,U as A,m as T,I as P,y as _,A as y,af as ne,t as se,S as re,x as ie,ac as me,ah as ue,v as ce}from"./index-C_bMx7Sy.js";/* empty css                */import{_ as pe}from"./index-B3SXiZrc.js";import{E as de,a as _e}from"./el-table-column-DTEsLnWC.js";import"./el-checkbox-DWmO-xWx.js";import{_ as fe}from"./index-C0LjHb4J.js";/* empty css               */import{_ as ve}from"./index-DOXSA2U9.js";/* empty css               */import{E as ge,a as he}from"./el-form-item-xEvDSTA9.js";import{a as we,b as be,c as Ce}from"./index-BSSXXUhN.js";import{_ as ye}from"./selectUser.vue_vue_type_script_setup_true_name_SelectUser_lang-BVunvMQk.js";import{E as Ie}from"./index-BJJBupNT.js";import{E as Ee}from"./index-CXLPzEIx.js";import{E as Se}from"./index-C8Rj31z0.js";import"./_initCloneObject-CAn0gXB7.js";/* empty css                */import"./index-C5rERorU.js";import"./_baseClone-DnTw8x3F.js";/* empty css                  */const ke={class:"p-2"},Ne={class:"search"},Ue=$({name:"AuthUser"}),Ye=$({...Ue,setup(Re){const F=ae(),{proxy:a}=le(),{sys_normal_disable:q}=Z(a==null?void 0:a.useDict("sys_normal_disable")),I=m([]),g=m(!0),f=m(!0),E=m(!0),h=m(0),S=m([]),k=m(),N=m(),r=x({pageNum:1,pageSize:10,roleId:F.params.roleId,userName:void 0,phonenumber:void 0}),u=async()=>{g.value=!0;const n=await we(r);I.value=n.rows,h.value=n.total,g.value=!1},B=()=>{const n={path:"/system/role",fullPath:"",hash:"",matched:[],meta:void 0,name:void 0,params:void 0,query:void 0,redirectedFrom:void 0};a==null||a.$tab.closeOpenPage(n)},d=()=>{r.pageNum=1,u()},D=()=>{var n;(n=k.value)==null||n.resetFields(),d()},L=n=>{S.value=n.map(o=>o.userId),E.value=!n.length},z=()=>{var n;(n=N.value)==null||n.show()},K=async n=>{await(a==null?void 0:a.$modal.confirm('确认要取消该用户"'+n.userName+'"角色吗？')),await be({userId:n.userId,roleId:r.roleId}),await u(),a==null||a.$modal.msgSuccess("取消授权成功")},Q=async()=>{const n=r.roleId,o=S.value.join(",");await(a==null?void 0:a.$modal.confirm("是否取消选中用户授权数据项?")),await Ce({roleId:n,userIds:o}),await u(),a==null||a.$modal.msgSuccess("取消授权成功")};return ee(()=>{u()}),(n,o)=>{var R,V;const U=re,w=ge,c=ie,j=he,b=Ee,O=ve,M=Se,i=de,G=fe,H=me,J=_e,W=pe,X=Ie,C=ue("hasPermi"),Y=ce;return v(),oe("div",ke,[e(te,{"enter-active-class":(R=l(a))==null?void 0:R.animate.searchAnimate.enter,"leave-active-class":(V=l(a))==null?void 0:V.animate.searchAnimate.leave},{default:t(()=>[p(T("div",Ne,[e(j,{ref_key:"queryFormRef",ref:k,model:l(r),inline:!0},{default:t(()=>[e(w,{label:"用户名称",prop:"userName"},{default:t(()=>[e(U,{modelValue:l(r).userName,"onUpdate:modelValue":o[0]||(o[0]=s=>l(r).userName=s),placeholder:"请输入用户名称",clearable:"",onKeyup:P(d,["enter"])},null,8,["modelValue"])]),_:1}),e(w,{label:"手机号码",prop:"phonenumber"},{default:t(()=>[e(U,{modelValue:l(r).phonenumber,"onUpdate:modelValue":o[1]||(o[1]=s=>l(r).phonenumber=s),placeholder:"请输入手机号码",clearable:"",onKeyup:P(d,["enter"])},null,8,["modelValue"])]),_:1}),e(w,null,{default:t(()=>[e(c,{type:"primary",icon:"Search",onClick:d},{default:t(()=>o[5]||(o[5]=[_("搜索")])),_:1}),e(c,{icon:"Refresh",onClick:D},{default:t(()=>o[6]||(o[6]=[_("重置")])),_:1})]),_:1})]),_:1},8,["model"])],512),[[A,l(f)]])]),_:1},8,["enter-active-class","leave-active-class"]),e(X,{shadow:"never"},{header:t(()=>[e(M,{gutter:10},{default:t(()=>[e(b,{span:1.5},{default:t(()=>[p((v(),y(c,{type:"primary",plain:"",icon:"Plus",onClick:z},{default:t(()=>o[7]||(o[7]=[_("添加用户")])),_:1})),[[C,["system:role:add"]]])]),_:1}),e(b,{span:1.5},{default:t(()=>[p((v(),y(c,{type:"danger",plain:"",icon:"CircleClose",disabled:l(E),onClick:Q},{default:t(()=>o[8]||(o[8]=[_(" 批量取消授权 ")])),_:1},8,["disabled"])),[[C,["system:role:remove"]]])]),_:1}),e(b,{span:1.5},{default:t(()=>[e(c,{type:"warning",plain:"",icon:"Close",onClick:B},{default:t(()=>o[9]||(o[9]=[_("关闭")])),_:1})]),_:1}),e(O,{showSearch:l(f),"onUpdate:showSearch":o[2]||(o[2]=s=>ne(f)?f.value=s:null),search:!0,onQueryTable:u},null,8,["showSearch"])]),_:1})]),default:t(()=>[p((v(),y(J,{data:l(I),onSelectionChange:L},{default:t(()=>[e(i,{type:"selection",width:"55",align:"center"}),e(i,{label:"用户名称",prop:"userName","show-overflow-tooltip":!0}),e(i,{label:"用户昵称",prop:"nickName","show-overflow-tooltip":!0}),e(i,{label:"邮箱",prop:"email","show-overflow-tooltip":!0}),e(i,{label:"手机",prop:"phonenumber","show-overflow-tooltip":!0}),e(i,{label:"状态",align:"center",prop:"status"},{default:t(s=>[e(G,{options:l(q),value:s.row.status},null,8,["options","value"])]),_:1}),e(i,{label:"创建时间",align:"center",prop:"createTime",width:"180"},{default:t(s=>[T("span",null,se(s.row.createTime),1)]),_:1}),e(i,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:t(s=>[e(H,{content:"取消授权",placement:"top"},{default:t(()=>[p(e(c,{link:"",type:"primary",icon:"CircleClose",onClick:Ve=>K(s.row)},null,8,["onClick"]),[[C,["system:role:remove"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[Y,l(g)]]),p(e(W,{page:l(r).pageNum,"onUpdate:page":o[3]||(o[3]=s=>l(r).pageNum=s),limit:l(r).pageSize,"onUpdate:limit":o[4]||(o[4]=s=>l(r).pageSize=s),total:l(h),onPagination:u},null,8,["page","limit","total"]),[[A,l(h)>0]]),e(ye,{ref_key:"selectRef",ref:N,"role-id":l(r).roleId,onOk:d},null,8,["role-id"])]),_:1})])}}});export{Ye as default};
