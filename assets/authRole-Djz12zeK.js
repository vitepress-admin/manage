import{d as w,r as i,b as P,c as z,m as r,t as g,p as a,q as s,e as l,w as y,A as M,U as G,af as S,n as C,x as H,v as J,a as Q,a1 as W,o as V,ad as X,y as T,S as Y}from"./index-C_bMx7Sy.js";import{_ as Z}from"./index-B3SXiZrc.js";import{a as x,E as ee}from"./el-table-column-DTEsLnWC.js";import"./el-checkbox-DWmO-xWx.js";import{a as te,E as le}from"./el-form-item-xEvDSTA9.js";/* empty css               *//* empty css               */import{u as ae,a as oe}from"./index-BAugWTfW.js";import{E as ne}from"./index-CXLPzEIx.js";import{E as se}from"./index-C8Rj31z0.js";import"./_initCloneObject-CAn0gXB7.js";import"./_baseClone-DnTw8x3F.js";const ie={class:"p-2"},re={class:"panel"},ue={class:"panel-title"},me={class:"panel"},de={class:"panel-title"},ce={style:{"text-align":"center","margin-left":"-120px","margin-top":"30px"}},pe=w({name:"AuthRole"}),Se=w({...pe,setup(fe){const I=Q(),{proxy:m}=W(),b=i(!0),h=i(0),c=i(1),p=i(10),$=i([]),k=i([]),_=i([]),d=i({nickName:void 0,userName:"",userId:void 0}),v=i(),j=e=>{var t;e.flag=!e.flag,(t=v.value)==null||t.toggleRowSelection(e,e.flag)},A=e=>{$.value=e.map(t=>t.roleId)},B=e=>String(e.roleId),E=()=>{const e={fullPath:"",hash:"",matched:[],meta:void 0,name:void 0,params:void 0,query:void 0,redirectedFrom:void 0,path:"/vpadmin/system/user"};m==null||m.$tab.closeOpenPage(e)},O=async()=>{const e=d.value.userId,t=$.value.join(",");await ae({userId:e,roleIds:t}).then(()=>{m==null||m.$modal.msgSuccess(m.$t("operationSuccess")),E()}).catch(()=>{C(()=>{k.value.forEach(n=>{var u;n!=null&&n.flag&&((u=v.value)==null||u.toggleRowSelection(n,!0))})})})},U=async()=>{const e=I.params&&I.params.userId;if(e){b.value=!0;const t=await oe(e);Object.assign(d.value,t.data.user),Object.assign(_.value,t.data.roles),h.value=_.value.length,Object.assign(k,_),await C(()=>{_.value.forEach(n=>{var u;n!=null&&n.flag&&((u=v.value)==null||u.toggleRowSelection(n,!0))})}),b.value=!1}};return P(()=>{U()}),(e,t)=>{const n=Y,u=le,N=ne,F=se,q=te,f=ee,D=x,K=Z,R=H,L=J;return V(),z("div",ie,[r("div",re,[r("h4",ue,g(e.$t("basicInfo")),1),a(q,{model:l(d),inline:!0},{default:s(()=>[a(F,{gutter:10},{default:s(()=>[a(N,{span:2.5},{default:s(()=>[a(u,{label:e.$t("nickname"),prop:"nickName"},{default:s(()=>[a(n,{modelValue:l(d).nickName,"onUpdate:modelValue":t[0]||(t[0]=o=>l(d).nickName=o),disabled:""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),a(N,{span:2.5},{default:s(()=>[a(u,{label:e.$t("loginAccount"),prop:"userName"},{default:s(()=>[a(n,{modelValue:l(d).userName,"onUpdate:modelValue":t[1]||(t[1]=o=>l(d).userName=o),disabled:""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),r("div",me,[r("h4",de,g(e.$t("roleInfo")),1),r("div",null,[y((V(),M(D,{ref_key:"tableRef",ref:v,"row-key":B,data:l(_).slice((l(c)-1)*l(p),l(c)*l(p)),onRowClick:j,onSelectionChange:A},{default:s(()=>[a(f,{label:e.$t("serialNumber"),width:"55",type:"index",align:"center"},{default:s(o=>[r("span",null,g((l(c)-1)*l(p)+o.$index+1),1)]),_:1},8,["label"]),a(f,{type:"selection","reserve-selection":!0,width:"55"}),a(f,{label:e.$t("roleId"),align:"center",prop:"roleId"},null,8,["label"]),a(f,{label:e.$t("roleName"),align:"center",prop:"roleName"},null,8,["label"]),a(f,{label:e.$t("permissionCharacter"),align:"center",prop:"roleKey"},null,8,["label"]),a(f,{label:e.$t("creationTime"),align:"center",prop:"createTime",width:"180"},{default:s(o=>[r("span",null,g(l(X)(o.row.createTime)),1)]),_:1},8,["label"])]),_:1},8,["data"])),[[L,l(b)]]),y(a(K,{page:l(c),"onUpdate:page":t[2]||(t[2]=o=>S(c)?c.value=o:null),limit:l(p),"onUpdate:limit":t[3]||(t[3]=o=>S(p)?p.value=o:null),total:l(h)},null,8,["page","limit","total"]),[[G,l(h)>0]]),r("div",ce,[a(R,{type:"primary",onClick:t[4]||(t[4]=o=>O())},{default:s(()=>[T(g(e.$t("submit")),1)]),_:1}),a(R,{onClick:t[5]||(t[5]=o=>E())},{default:s(()=>[T(g(e.$t("back")),1)]),_:1})]),t[6]||(t[6]=r("div",null,null,-1))])])])}}});export{Se as default};
