import{d as x,a as D,r as i,b as K,o as y,c as L,m as s,p as l,q as n,e as t,w,A as P,t as C,ae as z,W as M,ag as S,y as V,n as W,U as G,x as H,v as J,a3 as Q}from"./index-BAuvOH7U.js";import{_ as X}from"./index-DhWSmCN8.js";import{E as Y,a as Z}from"./el-table-column-BxuOrZRB.js";import"./el-checkbox-CJO2Nzt4.js";import{E as ee,a as te}from"./el-form-item-CrUaNreY.js";/* empty css               *//* empty css               */import{u as le,a as oe}from"./index-DklbFAUH.js";import{E as ae}from"./index-DqZK7Cst.js";import{E as ne}from"./index-D0kpylGG.js";import"./_initCloneObject-B1WjiVDp.js";import"./_baseClone-ClgyB-Pi.js";const se={class:"p-2"},ie={class:"panel"},re={class:"panel"},ue={style:{"text-align":"center","margin-left":"-120px","margin-top":"30px"}},me=x({name:"AuthRole"}),ye=x({...me,setup(de){const k=D(),{proxy:m}=Q(),g=i(!0),v=i(0),d=i(1),p=i(10),E=i([]),f=i([]),r=i({nickName:void 0,userName:"",userId:void 0}),b=i(),T=o=>{var e;o.flag=!o.flag,(e=b.value)==null||e.toggleRowSelection(o,o.flag)},B=o=>{E.value=o.map(e=>e.roleId)},U=o=>String(o.roleId),I=()=>{const o={fullPath:"",hash:"",matched:[],meta:void 0,name:void 0,params:void 0,query:void 0,redirectedFrom:void 0,path:"/system/user"};m==null||m.$tab.closeOpenPage(o)},$=async()=>{const o=r.value.userId,e=E.value.join(",");await le({userId:o,roleIds:e}),m==null||m.$modal.msgSuccess("授权成功"),I()},h=async()=>{const o=k.params&&k.params.userId;if(o){g.value=!0;const e=await oe(o);Object.assign(r.value,e.data.user),Object.assign(f.value,e.data.roles),v.value=f.value.length,await W(()=>{f.value.forEach(u=>{var _;u!=null&&u.flag&&((_=b.value)==null||_.toggleRowSelection(u,!0))})}),g.value=!1}};return K(()=>{h()}),(o,e)=>{const u=G,_=ee,N=ae,j=ne,A=te,c=Y,F=Z,O=X,R=H,q=J;return y(),L("div",se,[s("div",ie,[e[6]||(e[6]=s("h4",{class:"panel-title"},"基本信息",-1)),l(A,{model:t(r),inline:!0},{default:n(()=>[l(j,{gutter:10},{default:n(()=>[l(N,{span:2.5},{default:n(()=>[l(_,{label:"用户昵称",prop:"nickName"},{default:n(()=>[l(u,{modelValue:t(r).nickName,"onUpdate:modelValue":e[0]||(e[0]=a=>t(r).nickName=a),disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),l(N,{span:2.5},{default:n(()=>[l(_,{label:"登录账号",prop:"userName"},{default:n(()=>[l(u,{modelValue:t(r).userName,"onUpdate:modelValue":e[1]||(e[1]=a=>t(r).userName=a),disabled:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),s("div",re,[e[10]||(e[10]=s("h4",{class:"panel-title"},"角色信息",-1)),s("div",null,[w((y(),P(F,{ref_key:"tableRef",ref:b,"row-key":U,data:t(f).slice((t(d)-1)*t(p),t(d)*t(p)),onRowClick:T,onSelectionChange:B},{default:n(()=>[l(c,{label:"序号",width:"55",type:"index",align:"center"},{default:n(a=>[s("span",null,C((t(d)-1)*t(p)+a.$index+1),1)]),_:1}),l(c,{type:"selection","reserve-selection":!0,width:"55"}),l(c,{label:"角色编号",align:"center",prop:"roleId"}),l(c,{label:"角色名称",align:"center",prop:"roleName"}),l(c,{label:"权限字符",align:"center",prop:"roleKey"}),l(c,{label:"创建时间",align:"center",prop:"createTime",width:"180"},{default:n(a=>[s("span",null,C(t(z)(a.row.createTime)),1)]),_:1})]),_:1},8,["data"])),[[q,t(g)]]),w(l(O,{page:t(d),"onUpdate:page":e[2]||(e[2]=a=>S(d)?d.value=a:null),limit:t(p),"onUpdate:limit":e[3]||(e[3]=a=>S(p)?p.value=a:null),total:t(v)},null,8,["page","limit","total"]),[[M,t(v)>0]]),s("div",ue,[l(R,{type:"primary",onClick:e[4]||(e[4]=a=>$())},{default:n(()=>e[7]||(e[7]=[V("提交")])),_:1}),l(R,{onClick:e[5]||(e[5]=a=>I())},{default:n(()=>e[8]||(e[8]=[V("返回")])),_:1})]),e[9]||(e[9]=s("div",null,null,-1))])])])}}});export{ye as default};
