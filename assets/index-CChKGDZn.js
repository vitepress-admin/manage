import{a4 as h,d as G,r as c,ad as j,ac as se,b as ue,ai as me,o as F,c as pe,p as t,q as l,w as f,m as M,e as o,I as ce,y as v,W as fe,ah as ve,A as W,ag as _e,a3 as ge,U as be,x as he,P as Ie,B as ye,v as we}from"./index-B9_8IJe0.js";/* empty css                  *//* empty css                */import"./el-checkbox-B0xBIaBW.js";import{E as Ee}from"./el-tree-select-BvLdgPrr.js";import{E as ke,a as Ve}from"./el-table-column-Bf4nXPrj.js";/* empty css               */import{_ as Ce}from"./index-DNGLl6SE.js";/* empty css               *//* empty css                */import{E as Te,a as Ne}from"./el-form-item-CTbaNcVh.js";import{E as Re}from"./index-uEHY0w0Z.js";import{E as qe}from"./index-B7Ht2YQ7.js";import{E as Fe}from"./index-i2vYkcqU.js";import"./index-DV-l4gey.js";import"./_initCloneObject-DrfOwJJW.js";import"./_baseClone-CY4Rh9zz.js";const z=i=>h({url:"/demo/tree/list",method:"get",params:i}),Se=i=>h({url:"/demo/tree/"+i,method:"get"}),Ue=i=>h({url:"/demo/tree",method:"post",data:i}),Ae=i=>h({url:"/demo/tree",method:"put",data:i}),Pe=i=>h({url:"/demo/tree/"+i,method:"delete"}),$e={class:"p-2"},xe={class:"mb-[10px]"},Be={class:"dialog-footer"},De=G({name:"Tree"}),at=G({...De,setup(i){const{proxy:n}=ge(),V=c([]),C=c([]),I=c(!1),y=c(!0),w=c(!0),_=c(!1),S=c(),T=c(),U=c(),s=j({visible:!1,title:""}),A={id:void 0,parentId:void 0,deptId:void 0,userId:void 0,treeName:void 0},H=j({form:{...A},queryParams:{parentId:void 0,deptId:void 0,userId:void 0,treeName:void 0},rules:{id:[{required:!0,message:"主键不能为空",trigger:"blur"}],parentId:[{required:!0,message:"父id不能为空",trigger:"blur"}],deptId:[{required:!0,message:"部门id不能为空",trigger:"blur"}],userId:[{required:!0,message:"用户id不能为空",trigger:"blur"}],treeName:[{required:!0,message:"值不能为空",trigger:"blur"}]}}),{queryParams:E,form:d,rules:J}=se(H),g=async()=>{_.value=!0;const a=await z(E.value),e=n==null?void 0:n.handleTree(a.data,"id","parentId");e&&(V.value=e,_.value=!1)},P=async()=>{const a=await z();C.value=[];const e={id:0,treeName:"顶级节点",children:[]};e.children=n==null?void 0:n.handleTree(a.data,"id","parentId"),C.value.push(e)},X=()=>{N(),s.visible=!1},N=()=>{var a;d.value={...A},(a=T.value)==null||a.resetFields()},R=()=>{g()},Y=()=>{var a;(a=S.value)==null||a.resetFields(),R()},$=a=>{N(),P(),a&&a.id?d.value.parentId=a.id:d.value.parentId=0,s.visible=!0,s.title="添加测试树"},Z=()=>{w.value=!w.value,x(V.value,w.value)},x=(a,e)=>{a.forEach(u=>{var m;(m=U.value)==null||m.toggleRowExpansion(u,e),u.children&&u.children.length>0&&x(u.children,e)})},ee=async a=>{N(),await P(),a&&(d.value.parentId=a.id);const e=await Se(a.id);Object.assign(d.value,e.data),s.visible=!0,s.title="修改测试树"},te=()=>{var a;(a=T.value)==null||a.validate(async e=>{e&&(I.value=!0,d.value.id?await Ae(d.value).finally(()=>I.value=!1):await Ue(d.value).finally(()=>I.value=!1),n==null||n.$modal.msgSuccess("操作成功"),s.visible=!1,await g())})},le=async a=>{await(n==null?void 0:n.$modal.confirm('是否确认删除测试树编号为"'+a.id+'"的数据项？')),_.value=!0,await Pe(a.id).finally(()=>_.value=!1),await g(),n==null||n.$modal.msgSuccess("删除成功")};return ue(()=>{g()}),(a,e)=>{var Q,K;const u=be,m=Te,p=he,B=Ne,D=Re,L=qe,ae=Ce,oe=Fe,b=ke,q=Ie,re=Ve,ne=Ee,de=ye,k=me("hasPermi"),ie=we;return F(),pe("div",$e,[t(ve,{"enter-active-class":(Q=o(n))==null?void 0:Q.animate.searchAnimate.enter,"leave-active-class":(K=o(n))==null?void 0:K.animate.searchAnimate.leave},{default:l(()=>[f(M("div",xe,[t(D,{shadow:"hover"},{default:l(()=>[t(B,{ref_key:"queryFormRef",ref:S,model:o(E),inline:!0},{default:l(()=>[t(m,{label:"树节点名",prop:"treeName"},{default:l(()=>[t(u,{modelValue:o(E).treeName,"onUpdate:modelValue":e[0]||(e[0]=r=>o(E).treeName=r),placeholder:"请输入树节点名",clearable:"",onKeyup:ce(R,["enter"])},null,8,["modelValue"])]),_:1}),t(m,null,{default:l(()=>[t(p,{type:"primary",icon:"Search",onClick:R},{default:l(()=>e[8]||(e[8]=[v("搜索")])),_:1}),t(p,{icon:"Refresh",onClick:Y},{default:l(()=>e[9]||(e[9]=[v("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[fe,o(y)]])]),_:1},8,["enter-active-class","leave-active-class"]),t(D,{shadow:"hover"},{header:l(()=>[t(oe,{gutter:10,class:"mb8"},{default:l(()=>[t(L,{span:1.5},{default:l(()=>[f((F(),W(p,{type:"primary",plain:"",icon:"Plus",onClick:e[1]||(e[1]=r=>$())},{default:l(()=>e[10]||(e[10]=[v("新增")])),_:1})),[[k,["demo:tree:add"]]])]),_:1}),t(L,{span:1.5},{default:l(()=>[t(p,{type:"info",plain:"",icon:"Sort",onClick:Z},{default:l(()=>e[11]||(e[11]=[v("展开/折叠")])),_:1})]),_:1}),t(ae,{showSearch:o(y),"onUpdate:showSearch":e[2]||(e[2]=r=>_e(y)?y.value=r:null),onQueryTable:g},null,8,["showSearch"])]),_:1})]),default:l(()=>[f((F(),W(re,{ref_key:"treeTableRef",ref:U,data:o(V),"row-key":"id","default-expand-all":o(w),"tree-props":{children:"children",hasChildren:"hasChildren"}},{default:l(()=>[t(b,{label:"父id",align:"center",prop:"parentId"}),t(b,{label:"部门id",align:"center",prop:"deptId"}),t(b,{label:"用户id",align:"center",prop:"userId"}),t(b,{label:"树节点名",align:"center",prop:"treeName"}),t(b,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:l(r=>[t(q,{content:"修改",placement:"top"},{default:l(()=>[f(t(p,{link:"",type:"primary",icon:"Edit",onClick:O=>ee(r.row)},null,8,["onClick"]),[[k,["demo:tree:edit"]]])]),_:2},1024),t(q,{content:"新增",placement:"top"},{default:l(()=>[f(t(p,{link:"",type:"primary",icon:"Plus",onClick:O=>$(r.row)},null,8,["onClick"]),[[k,["demo:tree:add"]]])]),_:2},1024),t(q,{content:"删除",placement:"top"},{default:l(()=>[f(t(p,{link:"",type:"primary",icon:"Delete",onClick:O=>le(r.row)},null,8,["onClick"]),[[k,["demo:tree:remove"]]])]),_:2},1024)]),_:1})]),_:1},8,["data","default-expand-all"])),[[ie,o(_)]])]),_:1}),t(de,{modelValue:o(s).visible,"onUpdate:modelValue":e[7]||(e[7]=r=>o(s).visible=r),title:o(s).title,width:"500px","append-to-body":""},{footer:l(()=>[M("div",Be,[t(p,{loading:o(I),type:"primary",onClick:te},{default:l(()=>e[12]||(e[12]=[v("确 定")])),_:1},8,["loading"]),t(p,{onClick:X},{default:l(()=>e[13]||(e[13]=[v("取 消")])),_:1})])]),default:l(()=>[t(B,{ref_key:"treeFormRef",ref:T,model:o(d),rules:o(J),"label-width":"80px"},{default:l(()=>[t(m,{label:"父id",prop:"parentId"},{default:l(()=>[t(ne,{modelValue:o(d).parentId,"onUpdate:modelValue":e[3]||(e[3]=r=>o(d).parentId=r),data:o(C),props:{value:"id",label:"treeName",children:"children"},"value-key":"id",placeholder:"请选择父id","check-strictly":""},null,8,["modelValue","data"])]),_:1}),t(m,{label:"部门id",prop:"deptId"},{default:l(()=>[t(u,{modelValue:o(d).deptId,"onUpdate:modelValue":e[4]||(e[4]=r=>o(d).deptId=r),placeholder:"请输入部门id"},null,8,["modelValue"])]),_:1}),t(m,{label:"用户id",prop:"userId"},{default:l(()=>[t(u,{modelValue:o(d).userId,"onUpdate:modelValue":e[5]||(e[5]=r=>o(d).userId=r),placeholder:"请输入用户id"},null,8,["modelValue"])]),_:1}),t(m,{label:"值",prop:"treeName"},{default:l(()=>[t(u,{modelValue:o(d).treeName,"onUpdate:modelValue":e[6]||(e[6]=r=>o(d).treeName=r),placeholder:"请输入值"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{at as default};
