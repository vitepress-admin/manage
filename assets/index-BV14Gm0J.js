import{a2 as E,d as le,aa as X,r as m,ab as Y,b as we,ah as Ee,o as c,c as $,p as a,q as r,w as P,m as Z,e as n,F as S,z as w,A as _,I as x,y as C,t as V,U as ee,ag as Le,af as Ne,i as ke,a1 as ye,av as Ie,P as Te,Q as qe,S as Re,x as Fe,ap as Be,ac as De,B as Ae,v as Ke}from"./index-C7R7Ff_h.js";/* empty css                  *//* empty css                       *//* empty css                 */import{_ as ze}from"./index-K2bJ4uEq.js";import{E as Qe,a as Me}from"./el-table-column-gJHuUjmz.js";import"./el-checkbox-D6YSS21w.js";import{_ as Oe}from"./index-dWvdMurD.js";/* empty css               */import{_ as Ge}from"./index-CD6MWevG.js";/* empty css               *//* empty css                */import{E as He,a as Je}from"./el-form-item-CD9gUfFS.js";import{g as We}from"./edit-D6OmBz-u.js";import{E as Xe}from"./index-ChxKv1L0.js";import{E as Ye}from"./index-JJgHAOim.js";import{E as Ze}from"./index-Cic-2Q0V.js";import{E as xe,a as et}from"./index-OXDIC_HW.js";import"./_initCloneObject-EGbd4KTH.js";/* empty css                */import"./index-D0qCDv79.js";import"./_baseClone-mEfsj3iq.js";const tt=p=>E({url:"/vpadmin/thirdPartyLoginConfig/list",method:"get",params:p}),lt=p=>E({url:"/vpadmin/thirdPartyLoginConfig/"+p,method:"get"}),at=p=>E({url:"/vpadmin/thirdPartyLoginConfig",method:"post",data:p}),te=p=>E({url:"/vpadmin/thirdPartyLoginConfig",method:"put",data:p}),ot=p=>E({url:"/vpadmin/thirdPartyLoginConfig/"+p,method:"delete"}),nt={class:"p-2"},rt={class:"mb-[10px]"},it={class:"dialog-footer"},st=le({name:"ThirdPartyLoginConfig"}),kt=le({...st,setup(p){const{proxy:e}=ye(),{sys_normal_disable:A,vpa_social_login_type:T}=X(e==null?void 0:e.useDict("sys_normal_disable","vpa_social_login_type")),K=m([]),L=m(!1),N=m(!0),k=m(!0),q=m([]),ae=m(!0),oe=m(!0),R=m(0),y=m([]),z=m(),F=m(),f=Y({visible:!1,title:"",isEdit:!1}),Q={id:void 0,platform:void 0,clientId:void 0,clientSecret:void 0,redirectUri:void 0,status:"0",projectName:void 0,projectId:void 0},ne=Y({form:{...Q},queryParams:{pageNum:1,pageSize:10,platform:void 0,projectName:void 0,redirectUri:void 0,status:void 0,params:{}},rules:{id:[{required:!0,message:e==null?void 0:e.$t("primaryKeyRequired"),trigger:"blur"}],platform:[{required:!0,message:e==null?void 0:e.$t("thirdPartyPlatformRequired"),trigger:"change"}],clientId:[{required:!0,message:e==null?void 0:e.$t("clientIdRequired"),trigger:"blur"}],clientSecret:[{required:!0,message:e==null?void 0:e.$t("clientSecretRequired"),trigger:"blur"}],redirectUri:[{required:!0,message:e==null?void 0:e.$t("redirectUriRequired"),trigger:"blur"}],status:[{required:!0,message:e==null?void 0:e.$t("statusRequired"),trigger:"change"}],projectId:[{required:!0,message:e==null?void 0:e.$t("projectRequired"),trigger:"change"}]}}),{queryParams:s,form:i,rules:re}=X(ne),h=async()=>{N.value=!0;const t=await tt(s.value);K.value=t.rows,R.value=t.total,N.value=!1},ie=()=>{B(),f.visible=!1},B=()=>{var t;i.value={...Q},(t=F.value)==null||t.resetFields()},I=()=>{s.value.pageNum=1,h()},se=()=>{var t;(t=z.value)==null||t.resetFields(),I()},de=t=>{q.value=t.map(o=>o.id),ae.value=t.length!=1,oe.value=!t.length},M=async()=>{try{const t=await We();y.value=t.data}catch(t){console.error(e==null?void 0:e.$t("failedToFetchProjectList"),t)}},ue=t=>{const o=y.value.find(d=>d.id===t);o?(i.value.redirectUri=`${o.domain}`,i.value.projectName=o.projectName):(i.value.redirectUri="",i.value.projectName=void 0)},ce=()=>{B(),M(),i.value.redirectUri="",i.value.projectName=void 0,i.value.status="0",f.visible=!0,f.title=e==null?void 0:e.$t("addThirdPartyLoginConfig")},me=async t=>{B(),await M();const o=(t==null?void 0:t.id)||q.value[0],d=await lt(o);if(Object.assign(i.value,d.data),i.value.projectId){const g=y.value.find(u=>u.id===i.value.projectId);g&&(i.value.redirectUri=`${g.domain}`,i.value.projectName=g.projectName)}f.visible=!0,f.title=e==null?void 0:e.$t("editThirdPartyLoginConfig")},pe=async(t,o)=>{try{const d=o==="0"?e==null?void 0:e.$t("confirmEnableConfig"):e==null?void 0:e.$t("confirmDisableConfig");await Ie.confirm(d,e==null?void 0:e.$t("confirmInfo"),{confirmButtonText:e==null?void 0:e.$t("confirm"),cancelButtonText:e==null?void 0:e.$t("cancel"),type:"warning"}),await te({...t,status:o}),e==null||e.$modal.msgSuccess(o==="0"?e==null?void 0:e.$t("enableSuccess"):e==null?void 0:e.$t("disableSuccess"))}catch(d){t.status=o==="0"?"1":"0",d!=="cancel"&&(console.error(e==null?void 0:e.$t("failedToUpdateStatus"),d),e==null||e.$modal.msgError(e==null?void 0:e.$t("operationFailed")))}},fe=()=>{var t;(t=F.value)==null||t.validate(async o=>{o&&(L.value=!0,i.value.id?await te(i.value).finally(()=>L.value=!1):await at(i.value).finally(()=>L.value=!1),e==null||e.$modal.msgSuccess(e==null?void 0:e.$t("operationSuccess")),f.visible=!1,await h())})},ge=async t=>{const o=(t==null?void 0:t.id)||q.value;await(e==null?void 0:e.$modal.confirm(e==null?void 0:e.$t("confirmDeleteThirdPartyLoginConfig",{ids:o})).finally(()=>N.value=!1)),await ot(o),e==null||e.$modal.msgSuccess(e==null?void 0:e.$t("deleteSuccess")),await h()};return we(()=>{h()}),(t,o)=>{var J,W;const d=Te,g=qe,u=He,U=Re,b=Fe,O=Je,G=Xe,ve=Ye,be=Ge,_e=Ze,v=Qe,he=Oe,$e=Be,H=De,Pe=Me,Ce=ze,Ve=xe,Ue=et,je=Ae,D=Ee("hasPermi"),Se=Ke;return c(),$("div",nt,[a(Le,{"enter-active-class":(J=n(e))==null?void 0:J.animate.searchAnimate.enter,"leave-active-class":(W=n(e))==null?void 0:W.animate.searchAnimate.leave},{default:r(()=>[P(Z("div",rt,[a(G,{shadow:"hover"},{default:r(()=>[a(O,{ref_key:"queryFormRef",ref:z,model:n(s),inline:!0,"label-width":"auto"},{default:r(()=>[a(u,{label:t.$t("thirdPartyPlatform"),prop:"platform"},{default:r(()=>[a(g,{modelValue:n(s).platform,"onUpdate:modelValue":o[0]||(o[0]=l=>n(s).platform=l),placeholder:t.$t("selectThirdPartyPlatform"),clearable:""},{default:r(()=>[(c(!0),$(S,null,w(n(T),l=>(c(),_(d,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(u,{label:t.$t("projectName"),prop:"projectName"},{default:r(()=>[a(U,{modelValue:n(s).projectName,"onUpdate:modelValue":o[1]||(o[1]=l=>n(s).projectName=l),placeholder:t.$t("enterProjectName"),clearable:"",onKeyup:x(I,["enter"])},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(u,{label:t.$t("redirectUri"),prop:"redirectUri"},{default:r(()=>[a(U,{modelValue:n(s).redirectUri,"onUpdate:modelValue":o[2]||(o[2]=l=>n(s).redirectUri=l),placeholder:t.$t("enterRedirectUri"),clearable:"",onKeyup:x(I,["enter"])},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(u,{label:t.$t("status"),prop:"status"},{default:r(()=>[a(g,{modelValue:n(s).status,"onUpdate:modelValue":o[3]||(o[3]=l=>n(s).status=l),placeholder:t.$t("selectStatus"),clearable:""},{default:r(()=>[(c(!0),$(S,null,w(n(A),l=>(c(),_(d,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(u,null,{default:r(()=>[a(b,{type:"primary",icon:"Search",onClick:I},{default:r(()=>[C(V(t.$t("search")),1)]),_:1}),a(b,{icon:"Refresh",onClick:se},{default:r(()=>[C(V(t.$t("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[ee,n(k)]])]),_:1},8,["enter-active-class","leave-active-class"]),a(G,{shadow:"never"},{header:r(()=>[a(_e,{gutter:10,class:"mb8"},{default:r(()=>[a(ve,{span:1.5},{default:r(()=>[P((c(),_(b,{type:"primary",plain:"",icon:"Plus",onClick:ce},{default:r(()=>[C(V(t.$t("add")),1)]),_:1})),[[D,["vpadmin:thirdPartyLoginConfig:add"]]])]),_:1}),a(be,{showSearch:n(k),"onUpdate:showSearch":o[4]||(o[4]=l=>Ne(k)?k.value=l:null),onQueryTable:h},null,8,["showSearch"])]),_:1})]),default:r(()=>[P((c(),_(Pe,{data:n(K),onSelectionChange:de},{default:r(()=>[a(v,{type:"selection",width:"55",align:"center"}),ke("",!0),a(v,{label:t.$t("thirdPartyPlatform"),align:"center",prop:"platform"},{default:r(l=>[a(he,{options:n(T),value:l.row.platform},null,8,["options","value"])]),_:1},8,["label"]),a(v,{label:t.$t("projectName"),align:"center",prop:"projectName"},null,8,["label"]),a(v,{label:t.$t("clientId"),align:"center",prop:"clientId"},null,8,["label"]),a(v,{label:t.$t("clientSecret"),align:"center",prop:"clientSecret"},null,8,["label"]),a(v,{label:t.$t("redirectUri"),align:"center",prop:"redirectUri"},null,8,["label"]),a(v,{key:"status",label:t.$t("status"),align:"center"},{default:r(l=>[a($e,{modelValue:l.row.status,"onUpdate:modelValue":j=>l.row.status=j,"active-value":"0","inactive-value":"1",onChange:j=>pe(l.row,j)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1},8,["label"]),a(v,{label:t.$t("operations"),align:"center","class-name":"small-padding fixed-width"},{default:r(l=>[a(H,{content:t.$t("edit"),placement:"top"},{default:r(()=>[P(a(b,{link:"",type:"primary",icon:"Edit",onClick:j=>me(l.row)},null,8,["onClick"]),[[D,["vpadmin:thirdPartyLoginConfig:edit"]]])]),_:2},1032,["content"]),a(H,{content:t.$t("delete"),placement:"top"},{default:r(()=>[P(a(b,{link:"",type:"primary",icon:"Delete",onClick:j=>ge(l.row)},null,8,["onClick"]),[[D,["vpadmin:thirdPartyLoginConfig:remove"]]])]),_:2},1032,["content"])]),_:1},8,["label"])]),_:1},8,["data"])),[[Se,n(N)]]),P(a(Ce,{page:n(s).pageNum,"onUpdate:page":o[5]||(o[5]=l=>n(s).pageNum=l),limit:n(s).pageSize,"onUpdate:limit":o[6]||(o[6]=l=>n(s).pageSize=l),total:n(R),onPagination:h},null,8,["page","limit","total"]),[[ee,n(R)>0]])]),_:1}),a(je,{modelValue:n(f).visible,"onUpdate:modelValue":o[13]||(o[13]=l=>n(f).visible=l),title:n(f).title,width:"500px","append-to-body":""},{footer:r(()=>[Z("div",it,[a(b,{loading:n(L),type:"primary",onClick:fe},{default:r(()=>[C(V(t.$t("confirm")),1)]),_:1},8,["loading"]),a(b,{onClick:ie},{default:r(()=>[C(V(t.$t("cancel")),1)]),_:1})])]),default:r(()=>[a(O,{ref_key:"thirdPartyLoginConfigFormRef",ref:F,model:n(i),rules:n(re),"label-width":"120px"},{default:r(()=>[a(u,{label:t.$t("projectName"),prop:"projectId"},{default:r(()=>[a(g,{modelValue:n(i).projectId,"onUpdate:modelValue":o[7]||(o[7]=l=>n(i).projectId=l),placeholder:t.$t("selectProject"),onChange:ue},{default:r(()=>[(c(!0),$(S,null,w(n(y),l=>(c(),_(d,{key:l.id,label:l.projectName,value:l.id,disabled:l.isAdmin==="N"},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(u,{label:t.$t("thirdPartyPlatform"),prop:"platform"},{default:r(()=>[a(g,{modelValue:n(i).platform,"onUpdate:modelValue":o[8]||(o[8]=l=>n(i).platform=l),placeholder:t.$t("selectThirdPartyPlatform")},{default:r(()=>[(c(!0),$(S,null,w(n(T),l=>(c(),_(d,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(u,{label:t.$t("clientId"),prop:"clientId"},{default:r(()=>[a(U,{modelValue:n(i).clientId,"onUpdate:modelValue":o[9]||(o[9]=l=>n(i).clientId=l),placeholder:t.$t("enterClientId")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(u,{label:t.$t("clientSecret"),prop:"clientSecret"},{default:r(()=>[a(U,{modelValue:n(i).clientSecret,"onUpdate:modelValue":o[10]||(o[10]=l=>n(i).clientSecret=l),placeholder:t.$t("enterClientSecret")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(u,{label:t.$t("redirectUri"),prop:"redirectUri"},{default:r(()=>[a(U,{modelValue:n(i).redirectUri,"onUpdate:modelValue":o[11]||(o[11]=l=>n(i).redirectUri=l),placeholder:t.$t("selectProjectToAutoFillRedirectUri"),disabled:""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(u,{label:t.$t("status"),prop:"status"},{default:r(()=>[a(Ue,{modelValue:n(i).status,"onUpdate:modelValue":o[12]||(o[12]=l=>n(i).status=l)},{default:r(()=>[(c(!0),$(S,null,w(n(A),l=>(c(),_(Ve,{key:l.value,value:l.value},{default:r(()=>[C(V(l.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{kt as default};
