import{d as ae,h as le,aa as j,r as u,ab as I,b as oe,o as m,c as C,p as a,q as o,w as q,m as M,e as n,I as F,F as re,z as ie,A as b,y as U,t as S,U as B,ag as ne,i as L,a1 as se,E as P,S as de,P as ue,Q as pe,x as me,ac as ce,v as ge}from"./index-B3LzELiE.js";import{_ as _e}from"./index-CXoVGxBR.js";import{E as ve,a as ye}from"./el-table-column-CQOoXjW-.js";import"./el-checkbox-xPRdhUat.js";import{_ as be}from"./index-BSv0mnWi.js";/* empty css               */import{_ as fe}from"./index-Bu0cXUfW.js";/* empty css                */import{E as De,a as we}from"./el-form-item-BL_RYDRY.js";import{E as qe}from"./el-date-picker-B22EvI69.js";import{_ as Se,l as he,g as ke}from"./DeployDetailDialog-BhseHeJX.js";import{E as Te}from"./index-DnBWqAwp.js";import{E as Ne}from"./index-D3ewx8iR.js";import"./_initCloneObject-BxBlDzv5.js";/* empty css                */import"./index-BKK1MkNt.js";import"./_baseClone-CDjyL11X.js";import"./index-Ca8VzXJM.js";/* empty css                  */import"./el-descriptions-item-DLzbg0Vi.js";const Ve={class:"p-2"},$e={class:"mb-[10px]"},et=ae({__name:"index",setup(Ee){const{t:r}=le(),{proxy:d}=se(),{vpa_deploy_status:h}=j(d==null?void 0:d.useDict("vpa_deploy_status")),k=u([]),f=u(!0),D=u(!0),w=u(0),g=u(["",""]),T=u();u();const s=I({visible:!1,title:r("deployDetails"),data:{projectName:"",deployDescription:"",startTime:"",errorMessage:""}}),H=I({form:{...{id:void 0,projectId:void 0,projectName:void 0,deployDescription:void 0,deployStatus:void 0,startTime:void 0,endTime:void 0,duration:void 0,commitId:void 0,errorMessage:void 0,deptId:void 0,userId:void 0}},queryParams:{pageNum:1,pageSize:10,projectName:void 0,deployDescription:void 0,deployStatus:void 0,params:{startTime:void 0}},rules:{id:[{required:!0,message:r("primaryKeyRequired"),trigger:"blur"}],projectId:[{required:!0,message:r("projectIdRequired"),trigger:"blur"}],projectName:[{required:!0,message:r("projectNameRequired"),trigger:"blur"}],deployDescription:[{required:!0,message:r("deployDescriptionRequired"),trigger:"blur"}],deployStatus:[{required:!0,message:r("deployStatusRequired"),trigger:"change"}],startTime:[{required:!0,message:r("startTimeRequired"),trigger:"blur"}],endTime:[{required:!0,message:r("endTimeRequired"),trigger:"blur"}],duration:[{required:!0,message:r("buildDurationRequired"),trigger:"blur"}],commitId:[{required:!0,message:r("commitIdRequired"),trigger:"blur"}],errorMessage:[{required:!0,message:r("errorMessageRequired"),trigger:"blur"}],deptId:[{required:!0,message:r("deptIdRequired"),trigger:"blur"}],userId:[{required:!0,message:r("userIdRequired"),trigger:"blur"}]}}),{queryParams:i,form:je,rules:Ie}=j(H),K=e=>{e&&e.trim()!==""?window.open(e,"_blank"):P.warning(r("noValidLinkProvided"))},_=async()=>{f.value=!0,i.value.params={},d==null||d.addDateRange(i.value,g.value,"StartTime");const e=await he(i.value);k.value=e.rows,w.value=e.total,f.value=!1},v=()=>{i.value.pageNum=1,_()},z=()=>{var e;g.value=["",""],(e=T.value)==null||e.resetFields(),v()},Q=async e=>{try{const l=await ke(e.id);s.data.projectName=l.data.projectName,s.data.deployDescription=l.data.deployDescription,s.data.startTime=l.data.startTime,s.data.errorMessage=l.data.errorMessage,s.visible=!0}catch{P.error(r("failedToGetDetails"))}};return oe(()=>{_()}),(e,l)=>{var E,R;const N=de,c=De,Y=ue,A=pe,G=qe,y=me,O=we,V=Te,J=fe,W=Ne,p=ve,X=be,$=ce,Z=ye,x=_e,ee=ge;return m(),C("div",Ve,[a(ne,{"enter-active-class":(E=n(d))==null?void 0:E.animate.searchAnimate.enter,"leave-active-class":(R=n(d))==null?void 0:R.animate.searchAnimate.leave},{default:o(()=>[q(M("div",$e,[a(V,{shadow:"hover"},{default:o(()=>[a(O,{ref_key:"queryFormRef",ref:T,model:n(i),inline:!0,"label-width":"auto"},{default:o(()=>[a(c,{label:e.$t("projectName"),prop:"projectName"},{default:o(()=>[a(N,{modelValue:n(i).projectName,"onUpdate:modelValue":l[0]||(l[0]=t=>n(i).projectName=t),placeholder:e.$t("enterProjectName"),clearable:"",onKeyup:F(v,["enter"])},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(c,{label:e.$t("deployDescription"),prop:"deployDescription"},{default:o(()=>[a(N,{modelValue:n(i).deployDescription,"onUpdate:modelValue":l[1]||(l[1]=t=>n(i).deployDescription=t),placeholder:e.$t("enterDeployDescription"),clearable:"",onKeyup:F(v,["enter"])},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(c,{label:e.$t("deployStatus"),prop:"deployStatus"},{default:o(()=>[a(A,{modelValue:n(i).deployStatus,"onUpdate:modelValue":l[2]||(l[2]=t=>n(i).deployStatus=t),placeholder:e.$t("selectDeployStatus"),clearable:""},{default:o(()=>[(m(!0),C(re,null,ie(n(h),t=>(m(),b(Y,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(c,{label:e.$t("startTime"),style:{width:"380px"}},{default:o(()=>[a(G,{modelValue:g.value,"onUpdate:modelValue":l[3]||(l[3]=t=>g.value=t),"value-format":"YYYY-MM-DD HH:mm:ss",type:"daterange","range-separator":"-","start-placeholder":e.$t("startDate"),"end-placeholder":e.$t("endDate"),"default-time":[new Date(2e3,1,1,0,0,0),new Date(2e3,1,1,23,59,59)]},null,8,["modelValue","start-placeholder","end-placeholder","default-time"])]),_:1},8,["label"]),a(c,null,{default:o(()=>[a(y,{type:"primary",icon:"Search",onClick:v},{default:o(()=>[U(S(e.$t("search")),1)]),_:1}),a(y,{icon:"Refresh",onClick:z},{default:o(()=>[U(S(e.$t("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[B,D.value]])]),_:1},8,["enter-active-class","leave-active-class"]),a(V,{shadow:"never"},{header:o(()=>[a(W,{gutter:10,class:"mb8"},{default:o(()=>[a(J,{showSearch:D.value,"onUpdate:showSearch":l[4]||(l[4]=t=>D.value=t),onQueryTable:_},null,8,["showSearch"])]),_:1})]),default:o(()=>[q((m(),b(Z,{data:k.value},{default:o(()=>[L("",!0),a(p,{label:e.$t("projectName"),align:"center",prop:"projectName"},null,8,["label"]),a(p,{label:e.$t("deployDescription"),align:"center",prop:"deployDescription"},null,8,["label"]),a(p,{label:e.$t("deployStatus"),align:"center",prop:"deployStatus"},{default:o(t=>[a(X,{options:n(h),value:t.row.deployStatus},null,8,["options","value"])]),_:1},8,["label"]),a(p,{label:e.$t("startTime"),align:"center",prop:"startTime",width:"180"},{default:o(t=>[M("span",null,S(e.parseTime(t.row.startTime)),1)]),_:1},8,["label"]),a(p,{label:e.$t("buildDuration"),align:"center",prop:"duration"},null,8,["label"]),a(p,{label:e.$t("operations"),align:"center","class-name":"small-padding fixed-width"},{default:o(t=>[t.row.deployStatus==="0"?(m(),b($,{key:0,content:e.$t("viewDetails"),placement:"top"},{default:o(()=>[a(y,{link:"",type:"primary",icon:"View",onClick:te=>Q(t.row)},null,8,["onClick"])]),_:2},1032,["content"])):t.row.deployStatus==="1"?(m(),b($,{key:1,content:t.row.remark,placement:"top"},{default:o(()=>[a(y,{link:"",type:"primary",icon:"Link",onClick:te=>K(t.row.remark)},null,8,["onClick"])]),_:2},1032,["content"])):L("",!0)]),_:1},8,["label"])]),_:1},8,["data"])),[[ee,f.value]]),q(a(x,{page:n(i).pageNum,"onUpdate:page":l[5]||(l[5]=t=>n(i).pageNum=t),limit:n(i).pageSize,"onUpdate:limit":l[6]||(l[6]=t=>n(i).pageSize=t),total:w.value,onPagination:_},null,8,["page","limit","total"]),[[B,w.value>0]])]),_:1}),a(Se,{modelValue:s.visible,"onUpdate:modelValue":l[7]||(l[7]=t=>s.visible=t),title:s.title,data:s.data},null,8,["modelValue","title","data"])])}}});export{et as default};
