import{d as te,a as Ne,r as d,ab as Ce,dx as ke,b as Ee,ah as x,o as p,c as D,p as t,q as n,w as m,m as $,e as o,F as H,z as J,A as f,I as W,af as X,y as b,U as Z,ag as he,t as ee,a1 as Se,dy as Ve,P as Ie,Q as Te,S as De,x as $e,ac as Re,B as Ue,v as Pe}from"./index-C_bMx7Sy.js";/* empty css                  */import{E as qe,a as Fe}from"./el-tab-pane-CjU-KKwt.js";import{E as ze}from"./el-link-DxLKELfh.js";import{_ as Le}from"./index-B3SXiZrc.js";import{E as Be,a as Oe}from"./el-table-column-DTEsLnWC.js";import"./el-checkbox-DWmO-xWx.js";/* empty css               */import{_ as Ae}from"./index-DOXSA2U9.js";/* empty css               *//* empty css                */import{E as Qe,a as Ye}from"./el-form-item-xEvDSTA9.js";import{E as Ge}from"./el-date-picker-BWh0BEAp.js";import{b as Ke,a as Me,c as je,s as xe,p as He,d as Je}from"./index-Cc73Zop-.js";import{_ as We}from"./importTable.vue_vue_type_script_setup_true_lang-DUuBz-1Q.js";import{E as Xe}from"./index-BJJBupNT.js";import{E as Ze}from"./index-CXLPzEIx.js";import{E as et}from"./index-C8Rj31z0.js";import"./_initCloneObject-CAn0gXB7.js";/* empty css                */import"./index-C5rERorU.js";import"./_baseClone-DnTw8x3F.js";import"./index-CcUhCbJL.js";const tt={class:"p-2"},at={class:"mb-[10px]"},lt=te({name:"Gen"}),It=te({...lt,setup(nt){const R=Ne(),{proxy:s}=Se(),U=d([]),V=d(!0),k=d(!0),E=d([]),P=d(!0),q=d(!0),I=d(0),v=d(["",""]),F=d(""),z=d([]),T=d(),L=d(),i=d({pageNum:1,pageSize:10,tableName:"",tableComment:"",dataName:""}),y=d({data:{},activeName:"domain.java"}),h=Ce({visible:!1,title:"代码预览"});ke(()=>{var e;const a=R.query.t;a!=null&&a!=F.value&&(F.value=a,i.value.pageNum=Number(R.query.pageNum),v.value=["",""],(e=T.value)==null||e.resetFields(),g())});const ae=async()=>{const a=await Me();z.value=a.data},g=async()=>{V.value=!0;const a=await Ke(s==null?void 0:s.addDateRange(i.value,v.value));U.value=a.rows,I.value=a.total,V.value=!1},w=()=>{i.value.pageNum=1,g()},B=async a=>{const e=(a==null?void 0:a.tableId)||E.value;if(e==""){s==null||s.$modal.msgError("请选择要生成的数据");return}(a==null?void 0:a.genType)==="1"?(await je(a.tableId),s==null||s.$modal.msgSuccess("成功生成到自定义路径："+a.genPath)):s==null||s.$download.zip("/tool/gen/batchGenCode?tableIdStr="+e,"ruoyi.zip")},le=async a=>{const e=a.tableId;await(s==null?void 0:s.$modal.confirm('确认要强制同步"'+a.tableName+'"表结构吗？')),await xe(e),s==null||s.$modal.msgSuccess("同步成功")},ne=()=>{var a;(a=L.value)==null||a.show(i.value.dataName)},oe=()=>{var a;v.value=["",""],(a=T.value)==null||a.resetFields(),w()},se=async a=>{const e=await He(a.tableId);y.value.data=e.data,h.visible=!0,y.value.activeName="domain.java"},ie=()=>{s==null||s.$modal.msgSuccess("复制成功")},de=a=>{E.value=a.map(e=>e.tableId),P.value=a.length!=1,q.value=!a.length},O=a=>{const e=(a==null?void 0:a.tableId)||E.value[0];Ve.push({path:"/tool/gen-edit/index/"+e,query:{pageNum:i.value.pageNum}})},A=async a=>{const e=(a==null?void 0:a.tableId)||E.value;await(s==null?void 0:s.$modal.confirm('是否确认删除表编号为"'+e+'"的数据项？')),await Je(e),await g(),s==null||s.$modal.msgSuccess("删除成功")};return Ee(()=>{g(),ae()}),(a,e)=>{var M,j;const Q=Ie,me=Te,N=Qe,Y=De,re=Ge,r=$e,ue=Ye,G=Xe,S=Ze,pe=Ae,ce=et,c=Be,C=Re,_e=Oe,fe=Le,be=ze,ve=qe,ge=Fe,ye=Ue,_=x("hasPermi"),we=Pe,K=x("copyText");return p(),D("div",tt,[t(he,{"enter-active-class":(M=o(s))==null?void 0:M.animate.searchAnimate.enter,"leave-active-class":(j=o(s))==null?void 0:j.animate.searchAnimate.leave},{default:n(()=>[m($("div",at,[t(G,{shadow:"hover"},{default:n(()=>[t(ue,{ref_key:"queryFormRef",ref:T,model:o(i),inline:!0},{default:n(()=>[t(N,{label:"数据源",prop:"dataName"},{default:n(()=>[t(me,{modelValue:o(i).dataName,"onUpdate:modelValue":e[0]||(e[0]=l=>o(i).dataName=l),filterable:"",clearable:"",placeholder:"请选择/输入数据源名称"},{default:n(()=>[t(Q,{key:"",label:"全部",value:""}),(p(!0),D(H,null,J(o(z),l=>(p(),f(Q,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(N,{label:"表名称",prop:"tableName"},{default:n(()=>[t(Y,{modelValue:o(i).tableName,"onUpdate:modelValue":e[1]||(e[1]=l=>o(i).tableName=l),placeholder:"请输入表名称",clearable:"",onKeyup:W(w,["enter"])},null,8,["modelValue"])]),_:1}),t(N,{label:"表描述",prop:"tableComment"},{default:n(()=>[t(Y,{modelValue:o(i).tableComment,"onUpdate:modelValue":e[2]||(e[2]=l=>o(i).tableComment=l),placeholder:"请输入表描述",clearable:"",onKeyup:W(w,["enter"])},null,8,["modelValue"])]),_:1}),t(N,{label:"创建时间",style:{width:"308px"}},{default:n(()=>[t(re,{modelValue:o(v),"onUpdate:modelValue":e[3]||(e[3]=l=>X(v)?v.value=l:null),"value-format":"YYYY-MM-DD",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1}),t(N,null,{default:n(()=>[t(r,{type:"primary",icon:"Search",onClick:w},{default:n(()=>e[12]||(e[12]=[b("搜索")])),_:1}),t(r,{icon:"Refresh",onClick:oe},{default:n(()=>e[13]||(e[13]=[b("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[Z,o(k)]])]),_:1},8,["enter-active-class","leave-active-class"]),t(G,{shadow:"hover"},{header:n(()=>[t(ce,{gutter:10,class:"mb8"},{default:n(()=>[t(S,{span:1.5},{default:n(()=>[m((p(),f(r,{type:"primary",plain:"",icon:"Download",onClick:e[4]||(e[4]=l=>B())},{default:n(()=>e[14]||(e[14]=[b("生成")])),_:1})),[[_,["tool:gen:code"]]])]),_:1}),t(S,{span:1.5},{default:n(()=>[m((p(),f(r,{type:"info",plain:"",icon:"Upload",onClick:ne},{default:n(()=>e[15]||(e[15]=[b("导入")])),_:1})),[[_,["tool:gen:import"]]])]),_:1}),t(S,{span:1.5},{default:n(()=>[m((p(),f(r,{type:"success",plain:"",icon:"Edit",disabled:o(P),onClick:e[5]||(e[5]=l=>O())},{default:n(()=>e[16]||(e[16]=[b("修改")])),_:1},8,["disabled"])),[[_,["tool:gen:edit"]]])]),_:1}),t(S,{span:1.5},{default:n(()=>[m((p(),f(r,{type:"danger",plain:"",icon:"Delete",disabled:o(q),onClick:e[6]||(e[6]=l=>A())},{default:n(()=>e[17]||(e[17]=[b(" 删除 ")])),_:1},8,["disabled"])),[[_,["tool:gen:remove"]]])]),_:1}),t(pe,{showSearch:o(k),"onUpdate:showSearch":e[7]||(e[7]=l=>X(k)?k.value=l:null),onQueryTable:g},null,8,["showSearch"])]),_:1})]),default:n(()=>[m((p(),f(_e,{data:o(U),onSelectionChange:de},{default:n(()=>[t(c,{type:"selection",align:"center",width:"55"}),t(c,{label:"序号",type:"index",width:"50",align:"center"},{default:n(l=>[$("span",null,ee((o(i).pageNum-1)*o(i).pageSize+l.$index+1),1)]),_:1}),t(c,{label:"数据源",align:"center",prop:"dataName","show-overflow-tooltip":!0}),t(c,{label:"表名称",align:"center",prop:"tableName","show-overflow-tooltip":!0}),t(c,{label:"表描述",align:"center",prop:"tableComment","show-overflow-tooltip":!0}),t(c,{label:"实体",align:"center",prop:"className","show-overflow-tooltip":!0}),t(c,{label:"创建时间",align:"center",prop:"createTime",width:"160"}),t(c,{label:"更新时间",align:"center",prop:"updateTime",width:"160"}),t(c,{label:"操作",align:"center",width:"330","class-name":"small-padding fixed-width"},{default:n(l=>[t(C,{content:"预览",placement:"top"},{default:n(()=>[m(t(r,{link:"",type:"primary",icon:"View",onClick:u=>se(l.row)},null,8,["onClick"]),[[_,["tool:gen:preview"]]])]),_:2},1024),t(C,{content:"编辑",placement:"top"},{default:n(()=>[m(t(r,{link:"",type:"primary",icon:"Edit",onClick:u=>O(l.row)},null,8,["onClick"]),[[_,["tool:gen:edit"]]])]),_:2},1024),t(C,{content:"删除",placement:"top"},{default:n(()=>[m(t(r,{link:"",type:"primary",icon:"Delete",onClick:u=>A(l.row)},null,8,["onClick"]),[[_,["tool:gen:remove"]]])]),_:2},1024),t(C,{content:"同步",placement:"top"},{default:n(()=>[m(t(r,{link:"",type:"primary",icon:"Refresh",onClick:u=>le(l.row)},null,8,["onClick"]),[[_,["tool:gen:edit"]]])]),_:2},1024),t(C,{content:"生成代码",placement:"top"},{default:n(()=>[m(t(r,{link:"",type:"primary",icon:"Download",onClick:u=>B(l.row)},null,8,["onClick"]),[[_,["tool:gen:code"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[we,o(V)]]),m(t(fe,{page:o(i).pageNum,"onUpdate:page":e[8]||(e[8]=l=>o(i).pageNum=l),limit:o(i).pageSize,"onUpdate:limit":e[9]||(e[9]=l=>o(i).pageSize=l),total:o(I),onPagination:g},null,8,["page","limit","total"]),[[Z,o(I)>0]])]),_:1}),t(ye,{modelValue:o(h).visible,"onUpdate:modelValue":e[11]||(e[11]=l=>o(h).visible=l),title:o(h).title,width:"80%",top:"5vh","append-to-body":"",class:"scrollbar"},{default:n(()=>[t(ge,{modelValue:o(y).activeName,"onUpdate:modelValue":e[10]||(e[10]=l=>o(y).activeName=l)},{default:n(()=>[(p(!0),D(H,null,J(o(y).data,(l,u)=>(p(),f(ve,{key:l,label:u.substring(u.lastIndexOf("/")+1,u.indexOf(".vm")),name:u.substring(u.lastIndexOf("/")+1,u.indexOf(".vm"))},{default:n(()=>[m((p(),f(be,{underline:!1,icon:"DocumentCopy",style:{float:"right"}},{default:n(()=>e[18]||(e[18]=[b("  复制 ")])),_:2},1024)),[[K,l],[K,ie,"callback"]]),$("pre",null,ee(l),1)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["modelValue","title"]),t(We,{ref_key:"importRef",ref:L,onOk:w},null,512)])}}});export{It as default};
