import{d as te,h as oe,C as ae,r as d,D as le,b as se,o as u,c as m,m as s,G as ne,p as o,q as a,y as c,t as i,w as ie,A as y,F,z as re,i as U,e as M,H as ue,I as R,J as de,K as ce,L as me,u as pe,a as fe,M as ge,N as ve,O as _e,E as N,x as be,P as we,Q as he,R as ke,S as ye,T as Ee,U as Ce,v as Ie,V as $e,_ as Ve}from"./index-BAuvOH7U.js";/* empty css                */import{E as Se,a as Le}from"./el-form-item-CrUaNreY.js";import{E as Fe}from"./el-checkbox-CJO2Nzt4.js";import{a as Ue}from"./auth-64KRuN8T.js";import{E as Me}from"./index-BoDGaK97.js";import"./_baseClone-ClgyB-Pi.js";import"./_initCloneObject-B1WjiVDp.js";const Te={class:"login-container"},qe={class:"top-bar"},Re={class:"right-buttons"},Ne={class:"hover-effect"},Be={class:"login"},Ge={class:"title"},Pe={class:"social-buttons"},We={class:"divider"},De={class:"text-center"},He=["src"],Ke={key:0},Oe={key:1},Ae={class:"text-center-forgot-password"},ze={class:"text-center"},Je={class:"el-login-footer"},Qe=te({__name:"vpadminlogin",setup(Ye){const{t:f}=oe(),B=ae(),v=pe(),G=fe(),E=d(!1),l=d({tenantId:"000001",username:"",password:"",rememberMe:!1,code:"",uuid:"",clientId:"436efb388d684aadab73ef3cbba8f287",grantType:"vpadminPassword",redirect:window.location.href}),P=()=>{window.open("/free-themes","_blank")},W={username:[{required:!0,trigger:"blur",message:f("pleaseEnterEmail")}],password:[{required:!0,trigger:"blur",message:f("pleaseEnterPassword")}],code:[{required:!0,trigger:"change",message:f("pleaseEnterVerificationCode")}]},D=!1,_=d(""),b=d(!1),w=d(!0),T=d(),C=d(!1),H=d(D),g=d([]),I=d("/");le(()=>v.currentRoute.value,t=>{I.value=t.query&&t.query.redirect?decodeURIComponent(t.query.redirect):I.value||"/"},{immediate:!0});const K=()=>{window.open("https://www.vpadmin.org","_blank")},O=()=>{v.push("/recovery")},$=()=>{var t;(t=T.value)==null||t.validate(async e=>{if(e){b.value=!0,l.value.rememberMe?(localStorage.setItem("username",String(l.value.username)),localStorage.setItem("password",String(l.value.password)),localStorage.setItem("rememberMe",String(l.value.rememberMe))):(localStorage.removeItem("username"),localStorage.removeItem("password"),localStorage.removeItem("rememberMe"));const[r]=await $e(B.login(l.value));if(r)w.value&&await V();else{const k=I.value||"/";await v.push(k)}b.value=!1}})},q=async()=>{C.value=!0,await V()},A=()=>{C.value=!1,_.value=""},V=async()=>{const t=await ge(),{data:e}=t;w.value=e.captchaEnabled===void 0?!0:e.captchaEnabled,w.value&&(_.value="data:image/gif;base64,"+e.img,l.value.uuid=e.uuid)},z=async()=>{const{data:t}=await ve();if(t.tenantEnabled&&(g.value=t.voList,g.value&&g.value.length>0)){const e=g.value.find(r=>r.tenantId==="000001");e&&(l.value.tenantId=e.tenantId)}},h=async t=>{E.value=!0;try{const e=await Ue(t,l.value.tenantId||"000001");e.code===_e.SUCCESS?window.location.href=e.data:N.error(f("loginFailed",{message:e.msg}))}catch(e){N.error(f("loginFailed",{message:e.message||"Unknown error"}))}finally{E.value=!1}},J=()=>{v.push("/register")};return se(()=>{G.query.showEmail==="true"&&q(),z()}),(t,e)=>{const r=be,k=we,Q=he,Y=ke,j=ye,p=Se,S=Ee,L=Ce,X=Fe,Z=Le,x=Me,ee=Ie;return u(),m("div",Te,[s("div",qe,[e[9]||(e[9]=s("a",{href:"https://www.vpadmin.org",target:"_blank",class:"logo-link"},[s("img",{src:ne,alt:"Vpadmin Logo",class:"logo"})],-1)),s("div",Re,[o(k,{content:t.$t("navbar.themes"),effect:"light",placement:"bottom"},{default:a(()=>[o(r,{link:"",type:"primary",onClick:K},{default:a(()=>[c(i(t.$t("guide")),1)]),_:1})]),_:1},8,["content"]),o(k,{content:t.$t("navbar.themes"),effect:"light",placement:"bottom"},{default:a(()=>[s("div",Ne,[o(Q,{"icon-class":"theme",style:{color:"#0b57d0"},onClick:P})])]),_:1},8,["content"])])]),s("div",Be,[ie((u(),y(x,{class:"login-card"},{default:a(()=>[s("h2",Ge,i(t.$t("loginToVpadmin")),1),C.value?(u(),m(F,{key:1},[o(Z,{ref_key:"loginFormRef",ref:T,model:l.value,rules:W,class:"login-form"},{default:a(()=>[H.value?(u(),y(p,{key:0,prop:"tenantId"},{default:a(()=>[o(j,{modelValue:l.value.tenantId,"onUpdate:modelValue":e[4]||(e[4]=n=>l.value.tenantId=n),filterable:"",placeholder:t.$t("selectOrEnterCompanyName"),style:{width:"100%"}},{default:a(()=>[(u(!0),m(F,null,re(g.value,n=>(u(),y(Y,{key:n.tenantId,label:n.companyName,value:n.tenantId},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1})):U("",!0),o(p,{prop:"username"},{default:a(()=>[o(L,{modelValue:l.value.username,"onUpdate:modelValue":e[5]||(e[5]=n=>l.value.username=n),type:"text",placeholder:t.$t("email")},{prefix:a(()=>[o(S,null,{default:a(()=>[o(M(ue))]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1}),o(p,{prop:"password"},{default:a(()=>[o(L,{modelValue:l.value.password,"onUpdate:modelValue":e[6]||(e[6]=n=>l.value.password=n),type:"password",placeholder:t.$t("password"),onKeyup:R($,["enter"])},{prefix:a(()=>[o(S,null,{default:a(()=>[o(M(de))]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1}),w.value?(u(),y(p,{key:1,prop:"code",class:"verify-code-item"},{default:a(()=>[o(L,{modelValue:l.value.code,"onUpdate:modelValue":e[7]||(e[7]=n=>l.value.code=n),"auto-complete":"off",placeholder:t.$t("verificationCode"),onKeyup:R($,["enter"])},{prefix:a(()=>[o(S,null,{default:a(()=>[o(M(ce))]),_:1})]),_:1},8,["modelValue","placeholder"]),_.value?(u(),m("img",{key:0,src:_.value,class:"login-code-img",onClick:V},null,8,He)):U("",!0)]),_:1})):U("",!0),o(p,null,{default:a(()=>[o(X,{modelValue:l.value.rememberMe,"onUpdate:modelValue":e[8]||(e[8]=n=>l.value.rememberMe=n)},{default:a(()=>[c(i(t.$t("rememberMe")),1)]),_:1},8,["modelValue"])]),_:1}),o(p,null,{default:a(()=>[o(r,{type:"primary",loading:b.value,class:"login-button",onClick:me($,["prevent"])},{default:a(()=>[b.value?(u(),m("span",Oe,i(t.$t("loggingIn")),1)):(u(),m("span",Ke,i(t.$t("login")),1))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),s("div",Ae,[o(r,{class:"link-button",onClick:A},{default:a(()=>[c(" ← "+i(t.$t("otherLoginOptions")),1)]),_:1}),o(r,{class:"link-button forgot-password",onClick:O},{default:a(()=>[c(i(t.$t("forgotPassword")),1)]),_:1})])],64)):(u(),m(F,{key:0},[s("div",Pe,[o(r,{class:"social-button github",onClick:e[0]||(e[0]=n=>h("github"))},{default:a(()=>[e[10]||(e[10]=s("i",{class:"fab fa-github"},null,-1)),c(" "+i(t.$t("continueWithGitHub")),1)]),_:1}),o(r,{class:"social-button gitlab",onClick:e[1]||(e[1]=n=>h("gitlab"))},{default:a(()=>[e[11]||(e[11]=s("i",{class:"fab fa-gitlab"},null,-1)),c(" "+i(t.$t("continueWithGitLab")),1)]),_:1}),o(r,{class:"social-button google",disabled:"",onClick:e[2]||(e[2]=n=>h("google"))},{default:a(()=>[e[12]||(e[12]=s("i",{class:"fab fa-google"},null,-1)),c(" "+i(t.$t("continueWithGoogle")),1)]),_:1}),o(r,{class:"social-button facebook",disabled:"",onClick:e[3]||(e[3]=n=>h("facebook"))},{default:a(()=>[e[13]||(e[13]=s("i",{class:"fab fa-facebook-f"},null,-1)),c(" "+i(t.$t("continueWithFacebook")),1)]),_:1})]),s("div",We,[s("span",null,i(t.$t("or")),1)]),s("div",De,[o(r,{class:"link-button email-button",onClick:q},{default:a(()=>[c(i(t.$t("continueWithEmail"))+" → ",1)]),_:1})])],64)),s("div",ze,[o(r,{class:"link-button signup-button",onClick:J},{default:a(()=>[c(i(t.$t("noAccountSignUp")),1)]),_:1})])]),_:1})),[[ee,E.value]])]),s("div",Je,[s("span",null,i(t.$t("copyright",{year:new Date().getFullYear()})),1)])])}}}),lt=Ve(Qe,[["__scopeId","data-v-ac83f589"]]);export{lt as default};
